{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Main.\n *\n * @package\n * @category    admin\n * @copyright  2024 mattandor <mattan@centricapp.co.il>\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/notification', 'core/str', 'core/url'], function($, ajax, notification, str, url) {\n    'use strict';\n\n    return {\n        init: function() {\n            var self = this;\n\n            this.elements = $('#stream-elements');\n            this.loadingbars = url.imageUrl('icones/loading-bars', 'stream');\n\n            $('body').on('click', '#stream-elements .list-item-grid', function() {\n                var itemid = $(this).data('itemid'),\n                    topic = $(this).find('.title').text();\n\n                self.selected(itemid, topic);\n            });\n\n            $('#stream-title-search')\n                .val($('#id_topic').val())\n                .keyup(function() {\n                    self.load();\n                });\n\n            this.load();\n        },\n        load: function() {\n            var self = this;\n            self.elements.html('<div style=\"text-align:center\"><img height=\"80\" src=\"' + self.loadingbars + '\" ></div>');\n            $('html, body').animate({\n                scrollTop: self.elements.offset().top - 100\n            }, 800);\n\n            ajax.call([{\n                methodname: 'mod_stream_video_list',\n                args: {\n                    term: $('#stream-title-search').val()\n                }\n            }])[0]\n                .then(function(response) {\n                    return self.list(response, self);\n                })\n                .catch(function(error) {\n                    return self.failed(error, self);\n                });\n        },\n        selected: function(identifier, topic) {\n            setTimeout(function() {\n                $('#id_identifier').val(identifier);\n                $('#id_topic').val(topic);\n                $('.list-item-grid').find('.item').removeClass('selected');\n                $('#video_identifier_' + identifier).find('.item').addClass('selected');\n            }, 100);\n        },\n        failed: function(error, self) {\n            return str.get_string('connectionfailed', 'mod_stream')\n                .then(function(connectionfailed) {\n                    return self.elements.html('<div class=\"alert alert-danger\">' + connectionfailed + error.message + '</div>');\n                });\n        },\n        list: function(response, self) {\n            self.selected($('#id_identifier').val(), $('#id_topic').val());\n            if (response.status == 'success') {\n                if (response.videos.length) {\n                    self.elements.html(\"\");\n                    $.each(response.videos, function(key, video) {\n                        var html =\n                            '<div class=\"col list-item-grid\" data-itemid=\"' + video.id + '\" ' +\n                            'id=\"video_identifier_' + video.id + '\">' +\n                            '    <span class=\"item\" >' +\n                            '        <img src=\"' + video.thumbnail + '\" height=\"133\" width=\"236\"><br>' +\n                            '        <span class=\"title\">' + video.title + '</span>' +\n                            '    </span>' +\n                            '</div>';\n                        self.elements.append(html);\n                    });\n                } else {\n                    return str.get_string('noresults', 'mod_stream')\n                        .then(function(noresults) {\n                            return self.elements.html('<div class=\"alert alert-info\">' + noresults + '</div>');\n                        });\n                }\n            }\n            return true;\n        },\n    };\n});\n"],"names":["define","$","ajax","notification","str","url","init","self","this","elements","loadingbars","imageUrl","on","itemid","data","topic","find","text","selected","val","keyup","load","html","animate","scrollTop","offset","top","call","methodname","args","term","then","response","list","catch","error","failed","identifier","setTimeout","removeClass","addClass","get_string","connectionfailed","message","status","videos","length","noresults","each","key","video","id","thumbnail","title","append"],"mappings":";;;;;;;;AAwBAA,yBAAO,CAAC,SAAU,YAAa,oBAAqB,WAAY,aAAa,SAASC,EAAGC,KAAMC,aAAcC,IAAKC,WAGvG,CACHC,KAAM,eACEC,KAAOC,UAENC,SAAWR,EAAE,yBACbS,YAAcL,IAAIM,SAAS,sBAAuB,UAEvDV,EAAE,QAAQW,GAAG,QAAS,oCAAoC,eAClDC,OAASZ,EAAEO,MAAMM,KAAK,UACtBC,MAAQd,EAAEO,MAAMQ,KAAK,UAAUC,OAEnCV,KAAKW,SAASL,OAAQE,UAG1Bd,EAAE,wBACGkB,IAAIlB,EAAE,aAAakB,OACnBC,OAAM,WACHb,KAAKc,eAGRA,QAETA,KAAM,eACEd,KAAOC,KACXD,KAAKE,SAASa,KAAK,wDAA0Df,KAAKG,YAAc,aAChGT,EAAE,cAAcsB,QAAQ,CACpBC,UAAWjB,KAAKE,SAASgB,SAASC,IAAM,KACzC,KAEHxB,KAAKyB,KAAK,CAAC,CACPC,WAAY,wBACZC,KAAM,CACFC,KAAM7B,EAAE,wBAAwBkB,UAEpC,GACCY,MAAK,SAASC,iBACJzB,KAAK0B,KAAKD,SAAUzB,SAE9B2B,OAAM,SAASC,cACL5B,KAAK6B,OAAOD,MAAO5B,UAGtCW,SAAU,SAASmB,WAAYtB,OAC3BuB,YAAW,WACPrC,EAAE,kBAAkBkB,IAAIkB,YACxBpC,EAAE,aAAakB,IAAIJ,OACnBd,EAAE,mBAAmBe,KAAK,SAASuB,YAAY,YAC/CtC,EAAE,qBAAuBoC,YAAYrB,KAAK,SAASwB,SAAS,cAC7D,MAEPJ,OAAQ,SAASD,MAAO5B,aACbH,IAAIqC,WAAW,mBAAoB,cACrCV,MAAK,SAASW,yBACJnC,KAAKE,SAASa,KAAK,mCAAqCoB,iBAAmBP,MAAMQ,QAAU,cAG9GV,KAAM,SAASD,SAAUzB,SACrBA,KAAKW,SAASjB,EAAE,kBAAkBkB,MAAOlB,EAAE,aAAakB,OACjC,WAAnBa,SAASY,OAAqB,KAC1BZ,SAASa,OAAOC,cAcT1C,IAAIqC,WAAW,YAAa,cAC9BV,MAAK,SAASgB,kBACJxC,KAAKE,SAASa,KAAK,iCAAmCyB,UAAY,aAfjFxC,KAAKE,SAASa,KAAK,IACnBrB,EAAE+C,KAAKhB,SAASa,QAAQ,SAASI,IAAKC,WAC9B5B,KACA,gDAAkD4B,MAAMC,GAAxD,0BAC0BD,MAAMC,GADhC,+CAGuBD,MAAME,UAH7B,8DAIiCF,MAAMG,MAJvC,2BAOJ9C,KAAKE,SAAS6C,OAAOhC,gBAS1B"}